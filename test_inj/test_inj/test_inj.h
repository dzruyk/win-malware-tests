#pragma once

struct MainCtx {
	//ptr to current bot module
	HMODULE current_module;
		
	struct {
		HANDLE current_handle;
		HANDLE kernel32;
	} handles;
};

#if IS_DEBUG > 0
#include <stdio.h>
#include <stdlib.h>

struct DebugCtx {
	FILE *logPath;

	FILE *(*fopen)(const char *, const char *);
	size_t (*fwrite)(const void *ptr, size_t, size_t, FILE *fp);
	int (*fclose)(FILE *stream);
	int (*fwprintf)(FILE *stream, const wchar_t *format, ...);
	int (*fflush)(FILE *stream);
};

extern struct DebugCtx debugCtx;

#endif

FARPROC getFunctionAddress(wchar_t *module, char *function, int forceLoad);

#define CWA(dll, function)	\
	getFunctionAddress(TEXT(dll), #function, 1)

extern struct MainCtx mainCtx;
