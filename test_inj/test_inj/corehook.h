#pragma once

#if defined _WIN64
  //FIXME
#else
	#define WRITE_JMP(mem, thisAddress, to) { \
	    *((LPBYTE)(mem)) = OPCODE_JMP;			\
	    *((DWORD *)(((LPBYTE)(mem)) + OPCODE_JMP_SIZE)) = \
	    (DWORD)((DWORD_PTR)(to) - (DWORD_PTR)(thisAddress) - INJECT_SIZE);\
	}
	#define OPCODE_JMP      0xE9
	#define OPCODE_JMP_SIZE 1 
	#define JMP_ADDR_SIZE   (sizeof(DWORD) + OPCODE_JMP_SIZE)
	#define INJECT_SIZE     JMP_ADDR_SIZE
	#define OPCODE_MAX_SIZE 15
#endif


bool hook_all(HANDLE proc);
DWORD hook_function(HANDLE proc, void *target, void *replacement, void *original);
bool patch_iat(void *img, void *target, void *replacement);