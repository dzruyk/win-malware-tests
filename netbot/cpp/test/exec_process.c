

#include <stdio.h>
#include <windows.h>

typedef enum {
	true = 1,
	false = 0
} bool;

int
main()
{

	HANDLE rp, wp;
	int ret;

	STARTUPINFO si;
	PROCESS_INFORMATION pi;

	ZeroMemory(&pi, sizeof(pi));
	ZeroMemory(&si, sizeof(si));
	
	CreatePipe(&rp, &wp, 0, 1);
	
	si.hStdOutput = wp;
	si.hStdInput = GetStdHandle(STD_INPUT_HANDLE);

	if (SetStdHandle(STD_INPUT_HANDLE, &rp) == 0)
		printf("set std handle error\n");

	printf("before create process\n");

	ret = CreateProcess(NULL,
		"hello.exe",
		NULL,
		NULL,
		true,
		NORMAL_PRIORITY_CLASS,
		NULL,
		NULL,
		&si,
		&pi);
	if (ret == 0)
		printf("Create process error\n");

	return 0;
}

